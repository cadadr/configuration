#!/bin/bash
# void --- frontend script for void linux tools

. $MYLIB/fns2.sh

script_name="$(basename $0)"
script_usage="COMMAND [ARGS]"

command="$1"

if [ -z "$command" ]; then
    exit_with_usage
fi

shift

case "$command" in
    refresh)
	exec sudo xbps-install -S
	;;
    update|upgrade)
	exec sudo xbps-install -Su
	;;
    install)
	exec sudo xbps-install -S $@
	;;
    uninstall|remove|delete)
	exec sudo xbps-remove $@
	;;
    search)
	exec xbps-query -Rs $@
	;;
    files)
	exec xbps-query -f $@ | $PAGER
	;;
    info)
	exec xbps-query -R $@ | $PAGER
	;;
    list-kernels|kernels)
        exec sudo vkpurge list
        ;;
    rm-kernels|del-kernels|purge-kernels)
        exec sudo vkpurge rm $@
        ;;
    clean)
	exec sudo xbps-remove -Oo
	;;
    # record packages into my newly installed packages file
    record)
	echo $@ >> $MYSYSTEM/new.txt
	;;
    install-record|insrec|irec)
        $0 install $@ && $0 record $@
        ;;
    # service management
    status)
        sudo sv status $@
        ;;
    enable-daemon|enable-service|enable)
        [ -e /var/service/$1 ]                  \
            && echo service already enabled: $1 \
            || sudo ln -Tvs /{etc/sv,var/service}/$1
        ;;
    *)
        exit_with_error_message 2 unknown command: $command
	;;
esac
